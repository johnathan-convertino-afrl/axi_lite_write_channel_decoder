\begin{titlepage}
  \begin{center}

  {\Huge axi\_lite\_write\_channel\_decoder}

  \vspace{25mm}

  \includegraphics[width=0.90\textwidth,height=\textheight,keepaspectratio]{img/AFRL.png}

  \vspace{25mm}

  \today

  \vspace{15mm}

  {\Large Jay Convertino}

  \end{center}
\end{titlepage}

\tableofcontents

\newpage

\section{Usage}

\subsection{Introduction}

\par
Main function of this core is allow axi lite write channel to pass data if there is an address match. Otherwise
this will block all data downstream which would initiate a transfer. Once a valid address is presented it will connect
in one clock cycle.

\subsection{Dependencies}

\par
The following are the dependencies of the cores.

\begin{itemize}
  \item fusesoc 2.X
  \item iverilog (simulation)
  \item cocotb (simulation)
\end{itemize}

\input{src/fusesoc/depend_fusesoc_info.tex}

\subsection{In a Project}
\par
Simply connect inline with the write address channel of the axi lite bus. Set the address to a valid value and the region to a power of two (makes the most sense anyways).
and the decoder will only allow valid traffic to be passed.

\begin{lstlisting}[language=Verilog]
  axi_lite_write_channel_decoder #(
    .ADDRESS_WIDTH(ADDRESS_WIDTH),
    .BUS_WIDTH(BUS_WIDTH),
    .SLAVE_ADDRESS(SLAVE_ADDRESS),
    .SLAVE_REGION(SLAVE_REGION)
  ) dut (
    .connected(connected),
    .aclk(aclk),
    .arstn(arstn),
    .s_axi_awaddr(s_axi_awaddr),
    .s_axi_awprot(s_axi_awprot),
    .s_axi_awvalid(s_axi_awvalid),
    .s_axi_awready(s_axi_awready),
    .s_axi_wdata(s_axi_wdata),
    .s_axi_wstrb(s_axi_wstrb),
    .s_axi_wvalid(s_axi_wvalid),
    .s_axi_wready(s_axi_wready),
    .s_axi_bresp(s_axi_bresp),
    .s_axi_bvalid(s_axi_bvalid),
    .s_axi_bready(s_axi_bready),
    .m_axi_awaddr(w_m_axi_awaddr),
    .m_axi_awprot(m_axi_awprot),
    .m_axi_awvalid(m_axi_awvalid),
    .m_axi_awready(m_axi_awready),
    .m_axi_wdata(m_axi_wdata),
    .m_axi_wstrb(m_axi_wstrb),
    .m_axi_wvalid(m_axi_wvalid),
    .m_axi_wready(m_axi_wready),
    .m_axi_bresp(m_axi_bresp),
    .m_axi_bvalid(m_axi_bvalid),
    .m_axi_bready(m_axi_bready)
  );
\end{lstlisting}

\section{Architecture}
\par
The only module is the axi\_lite\_write\_channel\_decoder module. It is listed below.

\begin{itemize}
  \item \textbf{axi\_lite\_write\_channel\_decoder} Only allow traffice for valid addresses. (see core for documentation).
\end{itemize}

Please see \ref{Module Documentation} for more information.

\section{Building}

\par
The axi\_lite\_write\_channel\_decoder core is written in Verilog 2001. They should synthesize in any modern FPGA software. The core comes as a fusesoc packaged core and can be included in any other core. Be sure to make sure you have meet the dependencies listed in the previous section. Linting is performed by verible using the lint target.

\subsection{fusesoc}
\par
Fusesoc is a system for building FPGA software without relying on the internal project management of the tool. Avoiding vendor lock in to Vivado or Quartus.
These cores, when included in a project, can be easily integrated and targets created based upon the end developer needs. The core by itself is not a part of
a system and should be integrated into a fusesoc based system. Simulations are setup to use fusesoc and are a part of its targets.

\subsection{Source Files}

\input{src/fusesoc/files_fusesoc_info.tex}

\subsection{Targets}

\input{src/fusesoc/targets_fusesoc_info.tex}

\subsection{Directory Guide}

\par
Below highlights important folders from the root of the directory.

\begin{enumerate}
  \item \textbf{docs} Contains all documentation related to this project.
    \begin{itemize}
      \item \textbf{manual} Contains user manual and github page that are generated from the latex sources.
      \item \textbf{specs} Contains specifications for the bus.
    \end{itemize}
  \item \textbf{src} Contains source files for the core
  \item \textbf{tb} Contains test bench files for iverilog and cocotb
    \begin{itemize}
      \item \textbf{cocotb} testbench files
    \end{itemize}
\end{enumerate}

\newpage

\section{Simulation}
\par
There are a few different simulations that can be run for this core.

\subsection{iverilog}
\par
iverilog is used for simple test benches for quick verification, visually, of the core.

\subsection{cocotb}
\par
To use the cocotb tests you must install the following python libraries.
\begin{lstlisting}[language=bash]
  $ pip install cocotb
\end{lstlisting}

Each module has a cocotb based simulation. These use the cocotb extensions APB and uP. To install
these locally use the following.cocotb
\begin{lstlisting}[language=bash]
  $ pip install --break-system-packages -e .
\end{lstlisting}

Then you must use the cocotb sim target. The targets above can be run with various parameters.
\begin{lstlisting}[language=bash]
  $ fusesoc run --target sim_cocotb AFRL:bus:axi_lite_write_channel_decoder:1.0.0
\end{lstlisting}

\newpage

\section{Module Documentation} \label{Module Documentation}

\par

\begin{itemize}
\item \textbf{axi\_lite\_write\_channel\_decoder} axi lite write channel decoder\\
\item \textbf{tb\_cocotb-py} Cocotb python test routines\\
\item \textbf{tb\_cocotb-v} Cocotb verilog test bench\\
\end{itemize}
The next sections document the module in detail.

